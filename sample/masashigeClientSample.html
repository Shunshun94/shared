<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<p>Sheet URL <input
	id="io-github-shunshun94-trpg-characterSheetsMasashige-client-url"
	value="http://character-sheets.appspot.com/dx3/edit.html?key=ahVzfmNoYXJhY3Rlci1zaGVldHMtbXByFgsSDUNoYXJhY3RlckRhdGEY8MGkAQw"
	type="text" /><button id="io-github-shunshun94-trpg-characterSheetsMasashige-client-exec">表示</button></p>
<pre id="io-github-shunshun94-trpg-characterSheetsMasashige-client-display"></pre>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src='../jquery/com/hiyoko/util/v2/utils.js'></script>
<script src="../jquery/io/github/shunshun94/trpg/characterSheetsMasashige/client.js"></script>
<script>
//From https://s8a.jp/jquery-text-with-lf
(function(r){function l(a){return b(a,c,t,function(a){return u[a]})}function m(a){return b(a,f,v,function(a){return w[a]})}function b(a,b,d,e){return a&&d.test(a)?a.replace(b,e):a}function d(a){if(null==a)return"";if("string"==typeof a)return a;if(Array.isArray(a))return a.map(d)+"";var b=a+"";return"0"==b&&1/a==-(1/0)?"-0":b}var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=/[&<>"']/g,t=new RegExp(c.source),w={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},f=/&(?:amp|lt|gt|quot|#39);/g,
	v=new RegExp(f.source),e=/<(?:.|\n)*?>/mg,n=new RegExp(e.source),g=/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,p=new RegExp(g.source),h=/<br\s*\/?>/mg,q=new RegExp(h.source);r.fn.textWithLF=function(a){var c=typeof a;return"undefined"==c?m(b(b(this.html(),h,q,"\n"),e,n,"")):this.html("function"==c?function(c,f){var k=a.call(this,c,m(b(b(f,h,q,"\n"),e,n,"")));return"undefined"==typeof k?k:b(l(d(k)),g,p,"$1<br>")}:b(l(d(a)),g,p,"$1<br>"))}})(jQuery);

var query = com.hiyoko.util.getQueries();

const displaySheetInfo = (url) => {
	const system = /appspot\.com\/(.*)\//.exec(url)[1];
	const id = /key=(.*)/.exec(url)[1];
		
	$('#io-github-shunshun94-trpg-characterSheetsMasashige-client-exec').parent().hide();
	
	(new io.github.shunshun94.trpg.characterSheetsMasashige.client(system)).sendRequest(id).done((result) => {
		$('#io-github-shunshun94-trpg-characterSheetsMasashige-client-display').textWithLF(JSON.stringify(result, null, '\t'));
		console.log(result);
	});
};

$('#io-github-shunshun94-trpg-characterSheetsMasashige-client-exec').click((event) => {
	displaySheetInfo($('#io-github-shunshun94-trpg-characterSheetsMasashige-client-url').val());
});

if(query.id && query.system) {
	displaySheetInfo(`http://character-sheets.appspot.com/${query.system}/edit.html?key=${query.id}`)
}
</script>




</body>
</html>